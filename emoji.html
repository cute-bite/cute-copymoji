<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Emoji Keyboard - Cute CopyMoji | Copy & Paste Emojis for Instagram, Twitter & More</title>
<meta name="description" content="Use the free Cute CopyMoji Emoji Keyboard to copy and paste emojis for Instagram, Twitter, and all social media in one click. Fast, easy, and mobile-friendly.">

  <link rel="stylesheet" href="./index.css" />
  <script src="./emoji-data.js" defer></script>

  <script>
/* FAST-RENDER for emoji grid (no structure change) */
(function(){
  const $grid  = document.getElementById('grid');
  const $empty = document.getElementById('empty');

  /* 1) 최초 화면: 아이템을 400개까지만 먼저 그려서 '보이는 속도' 개선 */
  function fastRenderInitial(){
    try{
      const items = (window.EMOJI_ITEMS || (typeof EMOJI_ITEMS!=='undefined'? EMOJI_ITEMS: []));
      if(!items || !items.length){ $empty.style.display='block'; return; }
      $empty.style.display='none';
      $grid.innerHTML='';

      const N = Math.min(400, items.length); // 첫 화면만 빠르게
      const frag = document.createDocumentFragment();
      for(let i=0;i<N;i++){
        const it = items[i];
        const card = document.createElement('button');
        card.type='button';
        card.className='emo-card';
        card.innerHTML = '<div class="emo-t">'+escapeHtml(it.t)+'</div>';
        frag.appendChild(card);
      }
      $grid.appendChild(frag);

      // 2) 남은 것들은 유휴시간/프레임 사이에 배치로 추가
      batchAppend(items, N);
    }catch(_){}
  }

  function batchAppend(items, start){
    const CHUNK = 300;
    let i = start;
    function tick(deadline){
      let count = 0;
      const frag = document.createDocumentFragment();
      while(i < items.length && count < CHUNK){
        const it = items[i++];
        const card = document.createElement('button');
        card.type='button';
        card.className='emo-card';
        card.innerHTML = '<div class="emo-t">'+escapeHtml(it.t)+'</div>';
        frag.appendChild(card);
        count++;
      }
      $grid.appendChild(frag);
      if(i < items.length) schedule(tick);
    }
    function schedule(fn){
      if('requestIdleCallback' in window) requestIdleCallback(fn);
      else requestAnimationFrame(()=>fn({ timeRemaining: ()=>5 }));
    }
    schedule(tick);
  }

  function escapeHtml(s){ return String(s).replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;' }[m])); }

  // 데이터 로드가 끝났을 때만 실행 (emoji-data.js가 window.EMOJI_ITEMS를 채움)
  function startWhenReady(){
    if (Array.isArray(window.EMOJI_ITEMS) && window.EMOJI_ITEMS.length) { fastRenderInitial(); return; }
    document.addEventListener('emojidata:ready', fastRenderInitial, { once:true });
  }
  if (document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', startWhenReady, { once:true });
  } else {
    startWhenReady();
  }
})();
</script>



  <style>
  /* ===== 필터 바 (emoticon.html과 동일 스타일) ===== */
  .filters {
    display:flex; flex-wrap:wrap; align-items:center; justify-content:center;
    gap:8px;
  }
  .filters .chip { margin:0; }
  .filters.is-collapsed { max-height:40px; overflow:hidden; position:relative; }
  .filters.is-collapsed::after {
    content:""; position:absolute; right:0; top:0; bottom:0; width:48px;
    background:linear-gradient(to right, transparent, #fff); pointer-events:none;
  }

  /* ===== 모달 ===== */
  .filter-modal{ position:fixed; inset:0; z-index:9999; background:rgba(0,0,0,.35); display:none; }
  .filter-modal.is-open{ display:block; }
  .filter-modal .box{
    position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
    width:min(900px,92vw); max-height:80vh; overflow:auto;
    background:#fff; border-radius:12px; padding:16px 16px 20px; box-shadow:0 20px 60px rgba(0,0,0,.25);
  }
  .filter-modal .header{ display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px; }
  .filter-modal .title{ font-weight:700; font-size:16px; }
  .filter-modal .close{ border:1px solid #ddd; background:#fff; border-radius:10px; padding:6px 10px; cursor:pointer; }
  .filter-modal .grid{ display:grid; grid-template-columns:repeat(auto-fill, minmax(120px, 1fr)); gap:8px; }
  .filter-modal .chip{ width:100%; text-align:center; }

  /* ===== 그리드/카드 (이모지에 맞게 폰트 크게) ===== */
  #grid{
    display:grid;
    grid-template-columns: repeat(10, 88px); /* 이모지라 칸을 더 촘촘하게 갯수변경 */
    gap:12px;
    justify-content:center;
    align-items:start;
    margin-top:20px;
  }
    @media (max-width: 900px){ #grid{ grid-template-columns: repeat(6, 88px); } }
    @media (max-width: 600px){ #grid{ grid-template-columns: repeat(4, 88px); } }


  .emo-card{
    position:relative; display:flex; flex-direction:column;
    width:88px; height:88px;
    border:1px solid var(--border); border-radius:10px; background:#fff;
    padding:4px 6px 6px 6px;
    transition:background .2s ease, box-shadow .2s ease, border-color .2s ease;
    cursor:pointer; overflow:hidden;
  }
  .emo-card:hover{ background:var(--chip); border-color:var(--border); box-shadow:var(--shadow); }

  .emo-meta{ position:absolute; top:6px; right:6px; }
  .fav-btn{
    padding:1px 6px; font-size:12px;
    border:1px solid var(--border); border-radius:8px; background:var(--card); cursor:pointer;
  }
  .fav-btn.is-active{ background:var(--chip); box-shadow:var(--shadow); }

  .emo-t{
    flex:1; display:flex; align-items:center; justify-content:center;
    font-size:34px; line-height:1; text-align:center;   /* 이모지 크게 */
    user-select:none;
  }

  /* 토스트 */
  #toast{position:fixed;left:50%;transform:translateX(-50%);bottom:24px;background:var(--card);border:1px solid var(--border);
    padding:8px 12px;border-radius:10px;box-shadow:var(--shadow);opacity:0;transition:opacity .2s}
  #toast.show{opacity:1}

  /* 이모지 전용 폰트 스택 추가 */
  .emoji, .emo-t {
    font-family:
      "Apple Color Emoji", "Segoe UI Emoji", "Noto Color Emoji",
      "Twemoji Mozilla", "EmojiOne Color",
      system-ui, sans-serif;
  }


  /* 이모지 카드/리스트 가운데 정렬 */
  .emoji-list, #grid, .grid {
    display: flex;
    flex-wrap: wrap;
    justify-content: center !important;
  }

  /* 혹시 flex가 안 먹는 구조일 경우 대비 */
  .emoji-list, #grid, .grid {
    text-align: center !important;
  }

  /* 개별 카드 안의 글자(이모지)도 중앙 */
  .emoji-card, .emoji-item {
    text-align: center !important;
    margin: 4px;
  }

  </style>
<style>
  /* Ensure emoji fonts + skip offscreen rendering for thousands of cards */
  .emo-t{
    font-family:
      "Apple Color Emoji","Segoe UI Emoji","Noto Color Emoji",
      "Twemoji Mozilla","EmojiOne Color",
      system-ui,sans-serif;
  }
  .emo-card{ content-visibility:auto; contain-intrinsic-size: 88px 88px; }
</style>


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4324510515730355" crossorigin="anonymous"></script>



</head>

<body class="theme-pink">
  <div id="app-header"></div>

  <main class="container" style="min-height:60vh">

    
  <!-- ✅ 인페이지 광고 (본문 안, 맨 위) -->
  <div id="ad-inpage" class="ad-slot">
    <!-- AdSense 반응형 디스플레이 유닛 코드 -->
  </div>

  
    <!-- EMOJI -->
    <section id="view-emoji">
      <div class="toolbar">
        <div class="search">
          <svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><circle cx="10.5" cy="10.5" r="6.5" stroke="currentColor" stroke-width="1.5"/></svg>
          <input id="q" type="search" placeholder="Search | e.g. faces, animals" aria-label="Search emojis" data-i18n-placeholder="searchPlaceholder"/>
        </div>
      </div>

      <div class="content">
        <div class="filters" role="tablist" aria-label="filters">
          <span class="hint" style="align-self:center"></span>
          <button class="chip is-active" data-filter="all" data-i18n="all">All</button>
          <!-- 기본 몇 개만, 나머지 태그는 데이터에서 자동 생성 -->
          <button class="chip" data-filter="faces" data-i18n="faces">Faces</button>
          <button class="chip" data-filter="animals" data-i18n="animals">Animals</button>
          <button class="chip" data-filter="food" data-i18n="food">Food</button>
          <button class="chip" data-filter="objects" data-i18n="objects">Objects</button>
          <button class="chip" data-filter="symbols" data-i18n="symbols">Symbols</button>
          <button class="chip" data-filter="nature" data-i18n="nature">Nature</button>
        </div>

        <section id="grid" class="grid" aria-live="polite"></section>
        <div id="empty" class="empty" data-i18n="noresults">No results.</div>
      </div>
    </section>
  </main>

  <!-- Toast -->
  <div id="toast" class="toast" role="status" aria-live="polite">Copied!</div>

  <div id="app-footer"></div>
  <script src="./include-layout.js" defer></script>

  <script>
    /* ===== Emoji page: render + favorites + search/filters ===== */
    const EMOJI_CUSTOM_KEY = 'emoji.custom.v1';
    const EMOJI_FAV_KEY    = 'emoji.favs.v1';

    function loadCustom(){ try{ return JSON.parse(localStorage.getItem(EMOJI_CUSTOM_KEY)||'[]'); }catch{ return []; } }
    function loadFavs(){   try{ return JSON.parse(localStorage.getItem(EMOJI_FAV_KEY)||'[]'); }catch{ return []; } }
    function saveFavs(v){ localStorage.setItem(EMOJI_FAV_KEY, JSON.stringify(v)); }
    function isFav(t){ return loadFavs().includes(t); }
    function toggleFav(t){ const f=loadFavs(); const i=f.indexOf(t); if(i>=0)f.splice(i,1); else f.push(t); saveFavs(f); }

    function allItems(){
      const base = (window.EMOJI_ITEMS || (typeof EMOJI_ITEMS!=='undefined' ? EMOJI_ITEMS : []));
      const seen = new Set(), out=[...loadCustom()];
      for (const it of base) {
        if (!it || !it.t) continue;
        if (seen.has(it.t)) continue;
        seen.add(it.t);
        out.push(it);
      }
      return out;
    }

    const $grid  = document.getElementById('grid');
    const $empty = document.getElementById('empty');
    const $q     = document.getElementById('q');
    let FILTER = 'all';

    function matchesFilter(it){
      if (FILTER==='all') return true;
      if (FILTER==='favorites') return isFav(it.t);
      const tags = (it.g || []).map(s=>String(s).toLowerCase());
      return tags.includes(FILTER);
    }
    function matchesQuery(it, q){
      if(!q) return true;
      q = q.toLowerCase();
      return (it.t||'').toLowerCase().includes(q)
          || (it.l||'').toLowerCase().includes(q)
          || ((it.g||[]).join(' ').toLowerCase().includes(q));
    }

    function render(){
      const query = ($q?.value||'').trim();
      const items = allItems().filter(it=>matchesFilter(it) && matchesQuery(it, query));

      $grid.innerHTML = '';
      if (!items.length){ $empty.style.display='block'; return; }
      $empty.style.display='none';

      for (const it of items){
        const favInit = isFav(it.t);

        const card = document.createElement('button');
        card.type='button';
        card.className='emo-card' + (favInit?' is-fav':'');
        card.innerHTML = `
          <div class="emo-t">${escapeHtml(it.t)}</div>
          <div class="emo-meta">
            <button class="fav-btn${favInit?' is-active':''}" type="button" aria-label="favorite" title="favorite">${favInit?'★':'☆'}</button>
          </div>
        `;

        // 텍스트 클릭 → 복사
        card.querySelector('.emo-t').addEventListener('click', async (e)=>{
          e.stopPropagation();
          await copyText(it.t); toast('Copied!');
        });

        // 즐겨찾기 토글
        const favBtn = card.querySelector('.fav-btn');
        favBtn.addEventListener('click', (e)=>{
          e.stopPropagation();
          toggleFav(it.t);
          const nowFav = isFav(it.t);
          favBtn.textContent = nowFav ? '★' : '☆';
          favBtn.classList.toggle('is-active', nowFav);
        });

        $grid.appendChild(card);
      }
    }

    // 필터/검색 바인딩
    document.querySelector('.filters')?.addEventListener('click', (e)=>{
      const btn = e.target.closest('[data-filter]'); if(!btn) return;
      document.querySelectorAll('.filters .chip').forEach(b=>b.classList.remove('is-active'));
      btn.classList.add('is-active');
      FILTER = (btn.dataset.filter||'all').toLowerCase();
      render();
    });
    $q?.addEventListener('input', render);

    // 유틸
    function escapeHtml(s){ return s.replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m])); }
    async function copyText(s){
      try{ await navigator.clipboard.writeText(s); }
      catch{
        const ta=document.createElement('textarea'); ta.value=s;
        document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove();
      }
    }
    function toast(msg){
      let t=document.getElementById('toast');
      if(!t){ t=document.createElement('div'); t.id='toast'; t.className='toast'; document.body.appendChild(t); }
      t.textContent=msg; t.classList.add('show'); clearTimeout(toast._t);
      toast._t=setTimeout(()=>t.classList.remove('show'), 900);
    }
  </script>

  <!-- ===== 데이터 & 초기화 ===== -->
  <script src="./emoji-data.official_groups.min.js?v=3" defer></script>
  <script>
    document.addEventListener('DOMContentLoaded', function(){
      if (!window.EMOJI_ITEMS && typeof EMOJI_ITEMS !== 'undefined') {
        window.EMOJI_ITEMS = EMOJI_ITEMS;
      }
      document.dispatchEvent(new Event('emojidata:ready'));
    });
  </script>

  <!-- 태그 자동 생성 + 모달(Show All Filters) -->
  <div id="filterModal" class="filter-modal" aria-hidden="true">
    <div class="box" role="dialog" aria-modal="true" aria-labelledby="filterModalTitle">
      <div class="header">
        <div id="filterModalTitle" class="title" data-i18n="allfilters">All Filters</div>
        <button class="close" type="button" data-action="closeFilterModal" data-i18n="close">Close</button>
      </div>
      <div class="grid" id="filterModalGrid"></div>
    </div>
  </div>

  <script>
  (function(){
    const filtersEl = document.querySelector('.filters');
    const modalEl   = document.getElementById('filterModal');
    const modalGrid = document.getElementById('filterModalGrid');
    if (!filtersEl || !modalEl || !modalGrid) return;

    filtersEl.classList.add('is-collapsed');

    // Show All Filters 버튼 (항상 All 앞)
    const allBtn = filtersEl.querySelector('[data-filter="all"]');
    let showAll  = filtersEl.querySelector('[data-filter="__alltags__"]');
    if (!showAll){
      showAll = document.createElement('button');
      showAll.className='chip';
      showAll.dataset.filter='__alltags__';
      showAll.textContent='Show All Filters';
      showAll.setAttribute('data-i18n','showallfilters');
      allBtn?.insertAdjacentElement('beforebegin', showAll);
    } else {
      showAll.textContent = 'Show All Filters';
    }

    // 데이터 준비되면 태그 자동 생성 + 첫 렌더
    function makeTagButtons(){
      const have = new Set(
        [...filtersEl.querySelectorAll('[data-filter]')].map(b=>(b.dataset.filter||'').toLowerCase())
      );
      const tags = new Set();
      (window.EMOJI_ITEMS || []).forEach(it => (it.g||[]).forEach(tag => tags.add(String(tag).toLowerCase())));

      const frag = document.createDocumentFragment();
      [...tags].filter(t => t!=='all' && t!=='__alltags__' && !have.has(t))
               .sort((a,b)=>a.localeCompare(b))
               .forEach(t=>{
                  const btn = document.createElement('button');
                  btn.className='chip';
                  btn.dataset.filter=t;
                  btn.textContent=t.charAt(0).toUpperCase()+t.slice(1);
                  frag.appendChild(btn);
               });
      filtersEl.appendChild(frag);

      // 한 줄에 최대 10개만 보이게 (Show All Filters / All 제외)
      const buttons = [...filtersEl.querySelectorAll('.chip')].filter(b=>{
        const df=(b.dataset.filter||'').toLowerCase();
        return df && df!=='__alltags__' && df!=='all';
      });
      buttons.forEach((btn,i)=>{ btn.style.display = i<10 ? '' : 'none'; });
    }

    document.addEventListener('emojidata:ready', () => {
      makeTagButtons();
      // ✅ 첫 페이지 진입 시 바로 All 결과 보이도록
      const e = new Event('input'); document.getElementById('q')?.dispatchEvent(e);
      // 혹시 모를 상태 꼬임 방지 + 즉시 렌더
      (window.render || (()=>{}))(); // 전역 render가 없으면 무시
    });

    // 모달 열기/닫기
    function openModal(){
      modalGrid.innerHTML='';
      [...filtersEl.querySelectorAll('.chip')].forEach(src=>{
        const df=(src.dataset.filter||'').toLowerCase();
        if (!df || df==='__alltags__' || df==='all') return;
        const b=document.createElement('button');
        b.className='chip'; b.type='button'; b.dataset.filter=df; b.textContent=src.textContent;
        modalGrid.appendChild(b);
      });
      modalEl.classList.add('is-open');
      modalEl.setAttribute('aria-hidden','false');
    }
    function closeModal(){
      modalEl.classList.remove('is-open');
      modalEl.setAttribute('aria-hidden','true');
    }

    filtersEl.addEventListener('click',(e)=>{
      const btn=e.target.closest('.chip'); if(!btn) return;
      const df=(btn.dataset.filter||'').toLowerCase();
      if (df==='__alltags__'){ openModal(); return; }
    });

    modalEl.addEventListener('click',(e)=>{
      if (e.target.matches('[data-action="closeFilterModal"]') || e.target===modalEl){ closeModal(); return; }
      const tagBtn=e.target.closest('.chip');
      if (tagBtn){
        const df=tagBtn.dataset.filter;
        const real=filtersEl.querySelector(`.chip[data-filter="${CSS.escape(df)}"]`);
        if (real) real.click();
        closeModal();
      }
    });

    // 언어 변경 시 라벨/placeholder 갱신 (include-layout.js가 이벤트를 쏴준다고 가정)
    document.addEventListener('language:changed', ()=>{
      const LANGS = window.languages||{}; const cl = localStorage.getItem('emo.language')||'en';
      const t = k => (LANGS[cl]||LANGS.en||{})[k] ?? (LANGS.en?LANGS.en[k]:k) ?? k;
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const key=el.getAttribute('data-i18n'); el.textContent = t(key);
      });
      document.querySelectorAll('[data-i18n-placeholder]').forEach(el=>{
        const key=el.getAttribute('data-i18n-placeholder');
        el.setAttribute('placeholder', t(key));
        el.setAttribute('aria-label', t(key));
      });
    });
  })();
  </script>
</body>
</html>
